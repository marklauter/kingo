# comments are prefixed with #
# rewrite set operators:
#   | = union operator
#   & = intersection operator
#   ! = exclusion operator
# rewrite rules:
#   directly assigned subjects = direct | dir
#   ComputedSubjectSetRewrite = computed <identifier> | cmp <identifier>
#   TupleToSubjectSetRewrite = tuple (<identifier>, <identifier>) | tpl (<identifier>, <identifier>)

# policy name
policy file

# empty relationship - implicit direct
rel owner

# relationship with union rewrite
rel editor (direct | cmp owner)

# relationship with union and exclusion rewrites
rel viewer ((direct | cmp editor | tpl (parent, viewer)) ! cmp banned)

# relationship with intersection rewrite
rel auditor (direct & cmp viewer)

# empty relationship - implicit direct
rel banned

# second policy defined within same document
policy folder
rel owner
rel viewer ((direct | cmp editor | tpl (parent, viewer)) ! cmp banned)
rel banned
